<%= render "nav_bar" %>

<% @projekt_phase.map_layers.each do |layer| %>
  <%= render partial: "custom/admin/shared/map/map_layer", locals: { layer: layer, return_path: namespace_projekt_phase_path(action: :map) } %>
<% end %>

<div id="new-map-layer">
  <%= link_to t("custom.map_layer.buttons.new_layer"), new_admin_map_layer_path(return_path: namespace_projekt_phase_path(action: :map), mappable_id: @projekt_phase.id, mappable_type: @projekt_phase.class.name), class: "button success margin-bottom", remote: true %>
</div>

<h2><%= t("admin.settings.index.map.title") %></h2>

<table>
  <thead>
    <tr>
      <th><%= t("admin.settings.setting") %></th>
      <th><%= t("admin.settings.setting_value") %></th>
    </tr>
  </thead>
  <tbody>

    <%= form_for(@projekt_phase.map_location, url: namespace_mappable_path(action: :update_map)) do |f| %>
      <%= render partial: "custom/admin/shared/map/map_settings_form", locals: { map_location_form: f, attribute: :latitude } %>
      <%= render partial: "custom/admin/shared/map/map_settings_form", locals: { map_location_form: f, attribute: :longitude } %>
      <%= render partial: "custom/admin/shared/map/map_settings_form", locals: { map_location_form: f, attribute: :zoom } %>
    <% end %>

    <!--
    <%#= form_for(@projekt_phase, url: admin_projekt_phase_path, as: :projekt_phase) do |f| %>
      <%#= hidden_field_tag :namespace, params[:controller].include?("projekt_management") ? "projekt_management" : "" %>
      <%#= render partial: "custom/admin/projekts/edit/projekt_map/map_settings_form", locals: { map_location_form: f, attribute: :color } %>
    <%# end %>
    -->

  </tbody>
</table>

<p><%= t("admin.settings.index.map.help") %></p>

<%= render "custom/admin/shared/map/map_form", mappable: @projekt_phase, map_location: @projekt_phase.map_location %>
