<main class="user-page">
  <div class="flex-layout">
    <div class="main-column">
      <%= render(Users::ProfileBannerComponent.new(user: current_user)) %>
      <div class="row margin-bottom">
        <div class="small-12 column">

          <h1 class="inline-block margin-bottom">
            <%= t("notifications.index.title") %>
          </h1>

          <%= link_to t("notifications.index.mark_all_as_read"),
                  mark_all_as_read_notifications_path, method: :put,
                  class: "button hollow float-right-medium" %>

          <ul class="menu simple clear">
            <li class="is-active">
              <h2><%= link_to t("notifications.index.unread"), notifications_path %></h2>
            </li>
            <li>
              <%= link_to t("notifications.index.read"), read_notifications_path %>
            </li>
          </ul>

          <% if @notifications.empty? %>
            <div data-alert class="callout primary margin-top clear">
              <%= t("notifications.index.empty_notifications") %>
            </div>
          <% else %>
            <ul class="no-bullet clear notifications-list">
              <% @notifications.each do |notification| %>
                <%= render "/notifications/notification", notification: notification %>
              <% end %>
            </ul>
          <% end %>
        </div>
      </div>
      <%= render Users::NewPublicActivityComponent.new(current_user) %>
    </div>
    <aside class="sidebar">
      <%= render Shared::SidebarCardComponent.new(title: t("custom.users.settings"), icon_name: "cog") do |c| %>
        <%= link_to t("custom.account.show.change_credentials_link"), edit_user_registration_path, class: "button hollow" %>
        <%= link_to t("custom.account.show.erase_account_link"), users_registrations_delete_form_path, class: "button hollow delete alert" %>
      <% end %>
      <% unless current_user.level_three_verified? %>
        <%= render Shared::SidebarCardComponent.new(title: t("custom.account.show.verification_tittle"), description: t("custom.account.show.verification_description"),  icon_name: "check") do |c| %>
          <div class="verify-account">
            <% if current_user.level_two_verified? %>
              <%= link_to t("account.show.finish_verification"), verification_path, class: "button success" %>
            <% else %>
              <%= link_to t("account.show.verify_my_account"), verification_path, class: "button success" %>
            <% end %>
          </div>
        <% end %>
      <% end %>
      <%= form_for @account, as: :account, url: account_path do |f| %>
        <%= render Shared::SidebarCardComponent.new(title: t("custom.account.show.personal_settings"), icon_name: "cog") do |c| %>
          <div>
            <%= f.check_box :public_activity, {label: t('custom.account.settings.public_activity')} %>
          </div>
          <div>
            <%= f.check_box :public_interests, {label: t('custom.account.settings.public_interests')} %>
          </div>
          <div>
            <%= f.check_box :email_on_direct_message, {label: t('custom.account.settings.email_on_direct_message')} %>
          </div>
          <%= f.submit t("custom.account.show.save_settings"), class: "button margin-top" %>
        <% end %>
        <%= render Shared::SidebarCardComponent.new(title: t("custom.account.show.notifications"), icon_name: "bell") do |c| %>
          <div>
            <%= f.check_box :email_on_comment, {label: t('custom.account.settings.email_on_comment')} %>
          </div>

          <div>
            <%= f.check_box :email_on_comment_reply, {label: t('custom.account.settings.email_on_comment_reply')} %>
          </div>

          <div>
            <%= f.check_box :newsletter, {label: t('custom.account.settings.newsletter')} %>
          </div>

          <div>
            <%= f.check_box :email_digest, {label: t('custom.account.settings.email_digest')} %>
          </div>

          <div>
            <%= f.check_box :email_on_direct_message, {label: t('custom.account.settings.email_on_direct_message')} %>
          </div>
          <%= f.submit t("custom.account.show.save_settings"), class: "button margin-top" %>
        <% end %>
          <% if @account&.administrator? || @account&.moderator? || @account&.projekt_manager? %>
            <%= render Shared::SidebarCardComponent.new(title: t("custom.account.show.admin_notifications"), icon_name: "user-cog") do |c| %>
              <div>
                <%= f.check_box :adm_email_on_new_comment,
                  {label: t('custom.account.settings.adm_email_on_new_comment')} %>
              </div>

              <div>
                <%= f.check_box :adm_email_on_new_proposal,
                  {label: t('custom.account.settings.adm_email_on_new_proposal')} %>
              </div>

              <div>
                <%= f.check_box :adm_email_on_new_debate,
                  {label: t('custom.account.settings.adm_email_on_new_debate')} %>
              </div>

              <div>
                <%= f.check_box :adm_email_on_new_deficiency_report,
                  {label: t('custom.account.settings.adm_email_on_new_deficiency_report')} %>
              </div>

              <div>
                <%= f.check_box :adm_email_on_new_manual_verification,
                  {label: t('custom.account.settings.adm_email_on_new_manual_verification')} %>
              </div>
              <%= f.submit t("custom.account.show.save_settings"), class: "button margin-top" %>
            <% end %>
          <% end %>
      <% end %>
    </aside>
  </div>
</main>
